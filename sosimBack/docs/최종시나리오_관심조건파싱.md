# 소심한 부동산 - AI 텍스트/음성 파싱 시나리오

## 1. 수정된 API 설계

### 조건 파싱 API (1단계)
```
POST /v1/filters/parse
Body: {
  "type": "text" | "voice",
  "content": "강남구 전세 3억 이하 남향" | <base64 audio>
}

Response: {
  "originalInput": "강남구 전세 3억 이하 남향",
  "filterName": "강남구 전세 관심조건",  // AI가 생성한 이름
  "conditions": {
    "local2": "강남구",
    "propertyType": "LEASE", 
    "priceMax": 30000,
    "direction": ["남"]
  },
  "humanReadable": "강남구 전세 3억원 이하 남향"
}
```

### 기존 등록 API 활용 (2단계)
```
POST /v1/filters  // 기존 API 그대로 사용
Body: {
  "filterName": "강남구 전세 관심조건",  // 1단계에서 받은 이름 (수정 가능)
  "conditions": {
    "local2": "강남구",
    "propertyType": "LEASE", 
    "priceMax": 30000,
    "direction": ["남"]
  }
}
```

## 2. 상세 사용자 시나리오

### 📱 텍스트 입력 시나리오

**1. 사용자 입력**
- 앱: "원하는 조건을 입력해주세요"
- 사용자: "강남구 전세 3억 이하 남향 아파트"

**2. AI 파싱 중**
- 앱: "조건을 분석하고 있습니다... 🤖"
- → POST /v1/filters/parse 호출

**3. 확인 화면 표시**
```
┌─────────────────────────────┐
│ 📝 입력하신 조건             │
│ "강남구 전세 3억 이하 남향"   │
│                            │
│ 🏷️ 관심조건명               │
│ "강남구 전세 관심조건"       │
│ [수정 ✏️]                   │
│                            │
│ 🔍 분석된 조건              │
│ • 지역: 강남구              │
│ • 거래: 전세               │
│ • 가격: 3억원 이하          │
│ • 방향: 남향               │
│                            │
│ [조건 수정하기] [등록하기]    │
└─────────────────────────────┘
```

**4. 사용자 선택**
- A) "등록하기" 클릭 → POST /v1/filters 호출 (파싱된 조건 그대로)
- B) "조건 수정하기" 클릭 → 조건 편집 화면으로 이동 → 수정 후 POST /v1/filters 호출

**5. 등록 완료**
- 앱: "✅ '강남구 전세 관심조건'이 등록되었습니다!"

### 🎤 음성 입력 시나리오

**1. 음성 녹음**
- 앱: 🎤 "말씀해주세요" 버튼 표시
- 사용자: "마포구에서 월세 백만원 이하로 지하철역 근처 찾아줘"

**2. 음성 처리 중**
- 앱: "음성을 분석하고 있습니다... 🎧"
- → Transcribe: 음성 → 텍스트 변환
- → Bedrock: 텍스트 → 구조화된 조건
- → POST /v1/filters/parse 호출

**3. 확인 화면 표시**
```
┌─────────────────────────────┐
│ 🎤 말씀하신 내용             │
│ "마포구에서 월세 백만원 이하로│
│  지하철역 근처 찾아줘"       │
│                            │
│ 🏷️ 관심조건명               │
│ "마포구 월세 관심조건"       │
│ [수정 ✏️]                   │
│                            │
│ 🔍 분석된 조건              │
│ • 지역: 마포구              │
│ • 거래: 월세               │
│ • 가격: 100만원 이하        │
│ • 기타: 지하철역 근처 (메모) │
│                            │
│ [다시 말하기] [조건 수정] [등록하기] │
└─────────────────────────────┘
```

**4. 사용자 선택**
- A) "등록하기" → POST /v1/filters 호출
- B) "조건 수정" → 편집 화면 → POST /v1/filters 호출  
- C) "다시 말하기" → 음성 재녹음

**5. 등록 완료**
- 앱: "✅ '마포구 월세 관심조건'이 등록되었습니다!"

## 3. AI 생성 filterName 예시

- 입력: "강남구 전세 3억 이하" → filterName: "강남구 전세 관심조건"
- 입력: "홍대 근처 월세 100만원 이하 원룸" → filterName: "홍대 월세 관심조건"
- 입력: "분당 신도시 아파트 매매 10억 이하" → filterName: "분당 아파트 매매 관심조건"
- 입력: "2호선 역세권 전세 5억 이하 남향" → filterName: "2호선 전세 관심조건"

## 4. 에러 처리 시나리오

### 🚫 파싱 실패 시
**사용자:** "그냥 좋은 집 찾아줘"

**확인 화면:**
```
┌─────────────────────────────┐
│ ⚠️ 조건을 정확히 파악하기    │
│    어려워요                 │
│                            │
│ 💡 이렇게 말씀해보세요:      │
│ • "강남구 전세 3억 이하"     │
│ • "마포구 월세 100만원 이하" │
│                            │
│ [다시 입력하기] [직접 설정하기] │
└─────────────────────────────┘
```

## 5. 장점

✅ **간단한 구조**: sessionId 불필요, 기존 API 재사용

✅ **유연성**: 사용자가 파싱 결과를 자유롭게 수정 가능

✅ **직관적**: AI가 생성한 조건명으로 이해하기 쉬움

✅ **확장성**: 기존 시스템과 완벽 호환

✅ **사용자 친화적**: 확인 후 등록으로 안전성 보장